# plots

Contains commands to visualize continuous metrics in structured files (JSON,
CSV, or TSV): [show](/doc/command-reference/plots/show),
[diff](/doc/command-reference/plots/diff).

## Synopsis

```usage
usage: dvc plots [-h] [-q | -v] {show,diff} ...

positional arguments:
  COMMAND
    show         Generate a plot image file from a continuous metrics
                 file.
    diff         Plot continuous metrics differences between commits in the
                 DVC repository, or between the last commit and the workspace.
```

## Description

DVC provides a set of commands to visualize _continuous metrics_ of machine
learning experiments. Usual examples of plots are AUC curves, loss functions,
and confusion matrices.

These metrics represent plots, and should be stored as data series in one of the
supported [file formats](#file-formats). Metrics files are created by users, or
generated by their modeling or data processing code.

The plot commands can work with metric files that are committed to a repository
history, data files controlled by DVC, or any other file in the
<abbr>workspace</abbr>. For example, the command `dvc plots diff` generates a
plot with two versions of the metrics:

```dvc
$ dvc plots diff -d logs.csv
file:///Users/dmitry/src/plot/logs.html
```

![](/img/plots_auc.svg)

DVC generates plots as HTML files that can be open with a web browser. These
HTML files use [Vega-Lite](https://vega.github.io/vega-lite/). Vega is a
declarative grammar for defining plots using JSON. The plots can also be saved
as SVG or PNG image filed from the browser.

### Difference between continuous and scalar metrics

DVC has two concepts for metrics for representing result of machine learning
training or data processing:

1. `dvc metrics` to represent scalar numbers such as AUC, true positive rate and
   others.
2. `dvc plots` to visualize continuous metrics such as AUC curves, loss
   functions, confusion matrices, and others.

In contrast to continuous metrics,
[scalar metrics](/doc/command-reference/metrics) should be stored in a
hierarchical files such as JSON and YAML and `dvc metrics diff` command can
represent difference between the metrics in different experiments as a float
numbers. Like `AUC` metrics is `0.801807` and was increase by `+0.037826` from
the previous value:

```dvc
$ dvc metrics diff
    Path       Metric    Value      Change
summary.json   AUC      0.801807   0.037826
```

### File formats

Supported file formats for continuous metrics are: JSON, CSV, TSV. DVC expects
to see an array (or multiple arrays) of objects (usually _float numbers_) in the
file.

In tabular file formats such as CSV and TSV, each column (or field) is an array.
Plot command can generate visuals for a specified column or a set of columns.
Like `AUC` column:

```
epoch, AUC, loss
34, 0.91935, 0.0317345
35, 0.91913, 0.0317829
36, 0.92256, 0.0304632
37, 0.92302, 0.0299015
```

In hierarchical file formats such as JSON, an array of JSON objects is expected.
Plot command can generate visuals for a specified field name or a set of fields
from the array's object. Like `val_loss` field in the `train` array in this
example:

```
{
  "train": [
    {"val_accuracy": 0.9665, "val_loss": 0.10757},
    {"val_accuracy": 0.9764, "val_loss": 0.07324},
    {"val_accuracy": 0.8770, "val_loss": 0.08136},
    {"val_accuracy": 0.8740, "val_loss": 0.09026},
    {"val_accuracy": 0.8795, "val_loss": 0.07640},
    {"val_accuracy": 0.8803, "val_loss": 0.07608},
    {"val_accuracy": 0.8987, "val_loss": 0.08455}
  ]
}
```

### Plot templates

DVC gives users the ability to change the Vega graph specification, and generate
plots in the format that best fits the their needs. At the same time, it does
not make <abbr>DVC projects</abbr> dependent on user visualization code, a
programming language, or specific environment. This allows DVC to stay agnostic.

Plot templates are stored in the `.dvc/plot/` directory as JSON files. A user
can define it's own templates or modify the existing ones. The default template
is `.dvc/plot/default.json`. User can change the template by `--template` or
`-t` option of `dvc plot show` or `dvc plots diff` commands and specifying a
file name.

For templates in the templates directory the path and the json extension are not
required. User can specify only `--template scatter` instead of
`--template .dvc/plot/scatter.json`. Any custom template can be added to the
template directory.

### Custom templates

User can define their own template for specific plot types. Any template file is
a JSON specification with predefined DVC anchors that help DVC to inject user's
data properly.

All input JSON files of `dvc plots show` and `dvc plots diff` commands are
combined together into a single array for the injection to a template file.

There are two important additional fields that DVC adds:

- `index` - self-incrementing, zero-based counter for the data rows/values. In
  many cases it corresponds to a machine learning training epoch or step number.

- `rev` - Git commit hash, tag, or branch of the plot file. This helps
  distinguish between different versions when using the `dvc plots diff`
  command.

DVC applies the same logic to all input CSV/TSV files but first transforms all
CSV data into JSON. DVC uses column names from a header for JSON conversion into
fields.

DVC template anchors:

- `<DVC_METRIC_DATA>` - Plotting command input data from either CSV or JSON
  files is converted to JSON array and injected instead of this anchor. Two
  additional fields will be added: `index` and `rev` (explained above).

- `<DVC_METRIC_TITLE>` - A plot title that can be defined by `--title` option.

- `<DVC_METRIC_Y>` - a field name for Y axis of the plot. It can be defined by
  `-y` option of the commands. The default field is the last field found in the
  input file: the last column in CSV file or the last field in the JSON array
  object.

- `<DVC_METRIC_X>` - a field name for Y axes. It can be defined by `-x` option.
  `index` is the default field for X.

- `<DVC_METRIC_Y_TITLE>` - a displayed field label for Y.

- `<DVC_METRIC_X_TITLE>` - a displayed field label for X.

## Options

- `-h`, `--help` - prints the usage/help message, and exit.

- `-q`, `--quiet` - do not write anything to standard output.

- `-v`, `--verbose` - displays detailed tracing information.

## Example: Tabular data

We'll use tabular metrics file `logs.csv` for this example:

```
epoch,accuracy,loss,val_accuracy,val_loss
0,0.9418667,0.19958884770199656,0.9679,0.10217399864746257
1,0.9763333,0.07896138601688048,0.9768,0.07310650711813942
2,0.98375,0.05241111190887168,0.9788,0.06665669009438716
3,0.98801666,0.03681169906261687,0.9781,0.06697812260198989
4,0.99111664,0.027362171787042946,0.978,0.07385754839298315
5,0.9932333,0.02069501801203781,0.9771,0.08009233058886166
6,0.9945,0.017702101902437668,0.9803,0.07830339228538505
7,0.9954,0.01396906608727198,0.9802,0.07247738889862157
```

Let's plot the last column (default behavior):

```dvc
$ dvc plots show logs.csv
file:///Users/usr/src/plot/logs.csv.html
```

![](/img/plots_show.svg)

Difference in this metric between the current project version and the previous
commit:

```dvc
$ dvc plots diff -d logs.csv HEAD^
file:///Users/usr/src/plot/logs.csv.html
```

![](/img/plots_diff.svg)

Visualize a specific field:

```dvc
$ dvc plots show -y loss logs.csv
file:///Users/usr/src/plot/logs.html
```

![](/img/plots_show_field.svg)

## Example: Confusion matrix

We'll use `classes.csv` for this example:

```csv
actual,predicted
cat,cat
cat,cat
cat,cat
cat,dog
cat,dinosaur
cat,dinosaur
cat,bird
turtle,dog
turtle,cat
...
```

Let's visualize it:

```dvc
$ dvc plots show classes.csv --template confusion -x actual -y predicted
file:///Users/usr/src/plot/classes.csv.html
```

![](/img/plots_show_confusion.svg)

> A confusion matrix [template](/doc/command-reference/plots#plot-templates) is
> predefined in DVC (found in `.dvc/plot/confusion.json`).
